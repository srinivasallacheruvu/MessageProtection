package com.yudiz.Message;import java.util.ArrayList;import java.util.List;import android.app.Activity;import android.app.AlertDialog;import android.app.Dialog;import android.content.DialogInterface;import android.content.Intent;import android.content.pm.PackageManager;import android.content.pm.ResolveInfo;import android.database.Cursor;import android.net.Uri;import android.os.Bundle;import android.speech.RecognizerIntent;import android.util.Log;import android.view.View;import android.view.View.OnClickListener;import android.widget.AdapterView;import android.widget.Button;import android.widget.EditText;import android.widget.ListView;import android.widget.TextView;import android.widget.Toast;import android.widget.AdapterView.OnItemClickListener;import android.widget.AdapterView.OnItemLongClickListener;public class ViewList extends Activity implements OnItemClickListener,		OnItemLongClickListener {	DBAdapter dbnumber;	DBAdapterSms dbsms;	ListView numberList;	Button btnSend, btnCancel;	EditText etSMS;	TextView txtNo;	Bundle b;	List<MessageContent> listBlockNumber;	AlertDialog.Builder builder, builderDetails;	BlockNumberLazyAdapter adapter;	Dialog dialog;	String blockNo;	@Override	protected void onResume() {		super.onResume();		setContentView(R.layout.viewnumber);		numberList = (ListView) findViewById(R.id.lvBlockNumber);		dbnumber = new DBAdapter(this);		dbsms = new DBAdapterSms(this);		b = new Bundle();		builder = new AlertDialog.Builder(this);		builderDetails = new AlertDialog.Builder(this);		listBlockNumber = new ArrayList<MessageContent>();		// -----object of dialog of options-----		dialog = new Dialog(this);		dialog.setContentView(R.layout.dialogsendsms);		dialog.setTitle("Send SMS : ");		txtNo = (TextView) dialog.findViewById(R.id.txtDialogNo);		btnSend = (Button) dialog.findViewById(R.id.btnDialogSend);		btnCancel = (Button) dialog.findViewById(R.id.btnDialogCancel);		etSMS = (EditText) dialog.findViewById(R.id.etDialogSMSBody);		dbnumber.open();		dbsms.open();		// -----get the all record of blocked number from local DB-----		Cursor cur = dbnumber.getAllRecords();		Cursor counter = dbsms.getCountSMS();		cur.moveToFirst();		// -----display the no of SMS for particular number-----		for (int i = 0; i < cur.getCount(); i++) {			MessageContent messageContent = new MessageContent();			messageContent.setNumber(cur.getString(1));			messageContent.setid(cur.getString(0));			if (counter.getCount() != 0) {				counter.moveToFirst();				for (int j = 0; j < counter.getCount(); j++) {					if (cur.getString(1).equals(counter.getString(0))) {						messageContent.setCount(counter.getString(1));						break;					} else {						messageContent.setCount("No SMS");					}					counter.moveToNext();				}			} else {				messageContent.setCount("No SMS");			}			listBlockNumber.add(messageContent);			cur.moveToNext();		}		adapter = new BlockNumberLazyAdapter(ViewList.this, listBlockNumber);		// -----set adapter for view all blocked number-----		numberList.setAdapter(adapter);		numberList.setOnItemClickListener(this);		numberList.setOnItemLongClickListener(this);				PackageManager pm = getPackageManager();		List<ResolveInfo> activities = pm.queryIntentActivities(new Intent(				RecognizerIntent.ACTION_RECOGNIZE_SPEECH), 0);		if (activities.size() != 0) {			System.out.println("if : ");		} else {			System.out.println("Else : ");		}	}	// -----method for view all SMS of particular number-----	@Override	public void onItemClick(AdapterView<?> arg0, View vi, int arg2, long arg3) {		final TextView tv = (TextView) vi.findViewById(R.id.txtBlockNo);		Intent i = new Intent(getApplicationContext(), ViewSMS.class);		b.putString("Number", tv.getText().toString());		i.putExtras(b);		startActivity(i);	}	// -----method for show the option for number by long click at number	@Override	public boolean onItemLongClick(AdapterView<?> arg0, View vi,			final int position, long arg3) {		final TextView tv = (TextView) vi.findViewById(R.id.txtBlockNo);		final CharSequence[] items = { "Delete Number", "Call", "Send SMS" };		blockNo = tv.getText().toString();		builder.setTitle("Number Options");		builder.setItems(items, new DialogInterface.OnClickListener() {			public void onClick(DialogInterface dialog, int item) {				switch (item) {				case 0:					deleteNumber(adapter.number.get(position).getid(), tv							.getText().toString());					dialog.dismiss();					break;				case 1:					Intent intent = new Intent(Intent.ACTION_CALL, Uri							.parse("tel:" + tv.getText().toString()));					startActivity(intent);					break;				case 2:					startVoiceRecognitionActivity();					break;				default:					break;				}			}		});		builder.show();		return false;	}	public void showDialog() {		txtNo.setText(blockNo);		dialog.show();		btnCancel.setOnClickListener(new OnClickListener() {			@Override			public void onClick(View v) {				dialog.dismiss();			}		});	}		//-----method for delete the number from blocked list and local DB	public void deleteNumber(final String id, final String no) {		builderDetails.setTitle("Number Delete");		builderDetails.setMessage("Do u want to Delete this Number.......")				.setPositiveButton("Ok", new DialogInterface.OnClickListener() {					public void onClick(DialogInterface dialog, int arg) {						dbnumber.deleteRecord(id);						dbsms.delete(no);						ViewList.this.finish();						Intent i = new Intent(getApplicationContext(),								ViewList.class);						startActivity(i);						dialog.dismiss();					}				}).setNegativeButton("Cancel",						new DialogInterface.OnClickListener() {							public void onClick(DialogInterface dialog, int id) {								dialog.cancel();							}						}).show();	}	public void displayMessage(String msg) {		Toast.makeText(ViewList.this, msg, Toast.LENGTH_SHORT).show();	}	private void startVoiceRecognitionActivity() {		Intent intent = new Intent("android.speech.action.RECOGNIZE_SPEECH");		intent.setAction(ACTIVITY_SERVICE);		try {			startActivityForResult(intent, 0);		} catch (Exception e) {			Log.e(":::ERROR::", e.toString());		}		Log.v(":::", "444");	}	@Override	protected void onActivityResult(int requestCode, int resultCode, Intent data) {		System.out.println("hi : "				+ data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS)						.toString());		super.onActivityResult(requestCode, resultCode, data);	}}